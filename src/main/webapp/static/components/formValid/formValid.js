define("components/formValid/formValid",["require","exports","module","components/jquery/jquery"],function(e){function t(e){this.options=r.extend({dom:null,rules:{},showSuccessStatus:!1,showErrorStatus:!0,errorStop:!1,errorDom:null,error:function(){},success:function(){}},e||{}),this.init()}var r=e("components/jquery/jquery");return t.prototype={init:function(){this.dom=r(this.options.dom),this.initRules(),this.reset()},initRules:function(){{var e=this,s=t.DEFAULT_RULES,i=t.ATTRIBUTE_PREFIX;t.ATTIBUTE_LENGTH,t.ATTRIBUTE_RULE}e.getElement().each(function(){var t=this.name;if(t){var o=r(this);r.each(s,function(r,s){var n=i+r;null!=o.attr(n)&&e.addRule(t,{rule:"length"==r?new RegExp("^\\S{"+o.attr(n)+"}$"):s.rule,errorText:o.attr(n+"-error")||s.errorText,successText:o.attr(n+"-success")||s.successText})})}})},check:function(e){var t,s=this,i=!0,o=s.options.rules,n=s.options.errorStop;s.reset(e,!1),e?(t={},t[e]=o[e]||{}):t=o;for(var u in t){var l=t[u],a=s.getElement(u),c=a.val(),f=!0;if(!a.length)return;r.isArray(l)||(l=[l]);for(var T,h=0;h<l.length;h++)if(T=l[h],"function"!=typeof T.rule||T.rule(c,u)?T.rule.constructor!=RegExp||T.rule.test(c,u)||(i=!1,f=!1):(i=!1,f=!1),!f){if(s.error(u,T.errorText),n)return i;break}f&&s.success(u,T.successText)}return i},error:function(e,t){this.options.showErrorStatus&&(t=t||"",this.setText(e,t||"","ui-formvalid-field-error",1)),this.options.error&&this.options.error.call(this,e,t)},success:function(e,t){this.options.showSuccessStatus&&(t=t||"",this.setText(e,t,"ui-formvalid-field-success",0)),this.options.success&&this.options.success.call(this,e,t)},setText:function(e,t,s,i){var o,n=this.options.errorDom;o=n?r(n):this.getElement(e).parent(),o.find('.ui-formvalid-field[data-formvalid-target="'+e+'"]').remove(),null!=t&&o.append('<span class="ui-formvalid-field '+s+'" data-formvalid-target="'+e+'">'+(t||"&nbsp;")+"</span>"),i&&n?o.show():o.hide()},reset:function(e,s){var i=this;if(e){var o;(null==s||s)&&(o=i.getElement(e).attr(t.ATTRIBUTE_DEFAULT)),i.setText(e,o,"ui-formvalid-field-default")}else i.getElement().each(function(){var e=this.name;e&&((null==s||s)&&(o=r(this).attr(t.ATTRIBUTE_DEFAULT)),i.setText(e,o,"ui-formvalid-field-default"))})},addRule:function(e,t){var s=this.options.rules[e]||[];r.isArray(s)||(s=[s]),s.push(t),this.options.rules[e]=s},getElement:function(e){return this.dom.find(e?"[name="+e+"]":"[name]")}},r.extend(t,{ATTRIBUTE_PREFIX:"data-formvalid-",DEFAULT_RULES:{required:{rule:/\S+/,errorText:"该字段必填"},email:{rule:/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/,errorText:"电子邮箱格式错误"},number:{rule:/^\d+$/,errorText:"请输入合法的数字"},length:{rule:/^[\s\S]*$/},mobile:{rule:/^\d{11}$/,errorText:"请输入合法的手机号码"}}}),t.ATTRIBUTE_DEFAULT=t.ATTRIBUTE_PREFIX+"default",t});